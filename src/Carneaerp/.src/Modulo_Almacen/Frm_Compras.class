' Gambas class file


Public Sub Form_Open()
  
  Me.Title = "GESTION DE COMPRAS"
  DteFechaRecepcion.Value = Date(Year(Now), Month(Now), Day(Now))
  DteFFacturaCompra.Value = Date(Year(Now), Month(Now), Day(Now))
  Configurar_Objetos_Compras()
  Configurar_DataSet_Compras("select * from compras")
'  Message.Info(CStr(Day(Now) & Month(Now) & Year(Now)))

End

Public Sub BtnSalirCompras_Click()

  Me.Close

End









''*************************** Funciones privadas****************************
''
''**************************************************************************



'' Configuracion del Datase de Comerciales<br>
'' Parametros:<br>
''    Sql --> Sentencia para cargar datos en el Dataset
Private Sub Configurar_DataSet_Compras(Sql As String)
  
  Dim Cabeceras As New String[]
  

  Cabeceras.Add("Codigo")
  Cabeceras.Add("Fecha Recepcion")
  Cabeceras.Add("Cantidad")
  Cabeceras.Add("Lote Compra")
  Cabeceras.Add("N. F. Compra")
  Cabeceras.Add("Higiene")
  Cabeceras.Add("C. O. Leptidos")
  Cabeceras.Add("Precio")
  Cabeceras.Add("Firma")
  Cabeceras.Add("Observaciones")
  Cabeceras.Add("Transporete")
  Cabeceras.Add("Stock")
  Cabeceras.Add("Proveedor")
  Cabeceras.Add("Materia Prima")
  DtsCompras.Connection = FMain.Conexion_Base_Datos
  DtsCompras.Table = sql
  DtbCompras.Labels = Cabeceras
  DtbCompras.view.Columns[0].Width = 90
  DtbCompras.view.Columns[1].Width = 150
  DtbCompras.view.Columns[2].Width = 100
  DtbCompras.view.Columns[3].Width = 150  
  DtbCompras.view.Columns[4].Width = 150  
  DtbCompras.view.Columns[5].Width = 100  
  DtbCompras.view.Columns[6].Width = 150
  DtbCompras.view.Columns[7].Width = 90  
  DtbCompras.view.Columns[8].Width = 90  
  DtbCompras.view.Columns[9].Width = 150  
  DtbCompras.view.Columns[10].Width = 150  
  DtbCompras.view.Columns[11].Width = 150  
  DtbCompras.view.Columns[12].Width = 150  
  DtbCompras.view.Columns[13].Width = 150
  
  
End

'' Configurarmos cuando abrimos el formulario.
'' Llenamos los combobox de Proveedores y Materias Primas.
'' Si las tablas estan vacias muestra un error.

Private Sub Configurar_Objetos_Compras()
  Dim Error_Tablas_Vacias As String
  Dim Error_V As Boolean
  Dim Numero_Clientes As Integer
  Dim Valor_Subcuenta_Iva As Integer
  Error_V = False
  
  If Utilidades.Tabla_Vacia("select * from proveedor") = 0 Then
     Error_Tablas_Vacias = "Deber Cear Proveedores"
     Error_V = True
    Else
      Utilidades.Llenar_Combobox("select * from proveedor", CmbProveedor, "razonsocial")  
    Endif
  
  If Utilidades.Tabla_Vacia("select * from materiaprima") = 0 Then
   
     Error_V = True
    If Error_Tablas_Vacias = "" Then
        Error_Tablas_Vacias = "Debe Cear Materias Primas en Articulos."
      Else
        Error_Tablas_Vacias = Error_Tablas_Vacias & " y Materias Primas en Articulos."
    Endif
    Else
      Utilidades.Llenar_Combobox("select * from materiaprima", CmbMateriaPrima, "nombre")  
  Endif
  
  If Error_V Then
    TxtlerrorCompras.Visible = True
    TxtlerrorCompras.text = Error_Tablas_Vacias
  Endif
  
  TxtlerrorCompras.text = Error_Tablas_Vacias
  
End
