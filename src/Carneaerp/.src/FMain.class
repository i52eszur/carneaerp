' Gambas class file

' Gambas class 
' Ruta de los directorios de trabajo
Public CarpetaCarnea As String = User.home & "/carnea"
Public DirConexion As String = User.home & "/.config/carnea/conexion"
Public FicheroConexionBD As New Settings(DirConexion & "/conexion.conf")

Public Conexion_Base_Datos As New Connection
   ' Variables para la conexion a la base de datos

'Public ConexionBD_Tipo As String = "mysql"
'Public ConexionBD_Puerto As String = "3306"


Public Sub Form_Open()
  'Me.Center
  Settings.Read(Me)
  Me.Title = "CARNEA ERP. Version : " & Application.Version
  CrearDirectorios()
  Comprobarficheros()
  
End
Private Sub CargarDatosConexion()
   
  Conexion_Base_Datos.Close
  Conexion_Base_Datos.Type = "mysql"
  Conexion_Base_Datos.Host = FicheroConexionBD["ConexionBD/Host"]
  Conexion_Base_Datos.Port = FicheroConexionBD["ConexionBD/Puerto"]
  Conexion_Base_Datos.User = FicheroConexionBD["ConexionBD/Usuario"]
  Conexion_Base_Datos.Password = Utilidades.cripto(2, FicheroConexionBD["ConexionBD/Password"])
  Conexion_Base_Datos.Name = FicheroConexionBD["ConexionBD/BaseDatos"]
  
    
End


Private Sub CrearDirectorios()
  'Message.Info(CarpetaCarnea)
  ' Si no existe el directorio de trabajo es la primera ejecucion del programa.
  If Not Exist(CarpetaCarnea) Then Mkdir CarpetaCarnea 
  If Not Exist(DirConexion) Then 
    Mkdir User.Home & "/.config/carnea"
    Mkdir DirConexion
  Endif
  Wait 0.5
End
Private Sub Comprobarficheros()
  
  If Not Exist(DirConexion & "/conexion.conf") Then
    Frm_Conexionbasedatos.ShowModal()  
  Else
    CargarDatosConexion()
  Endif
  
    
End


Public Sub MenuSalir_Click()

  Me.Close

End

Public Sub ButtonSalir_Click()
 Settings.write(Me)
  Me.close

End



Public Sub ButtonArticulos_Click()

  Frm_Articulos.ShowModal()

End



Public Sub ButtonuUtilidades_Click()

Frm_Utilidades.ShowModal()

End

Public Sub MenuConexionBd_Click()

  Frm_Conexionbasedatos.ShowModal()

End

Public Sub MenuArticulos_Click()

    Frm_Articulos.ShowModal()

End

Public Sub ButtonClientes_Click()

  Frm_Clientes.ShowModal()

End

Public Sub MenuClientes_Click()

  Frm_Clientes.ShowModal()

End

Public Sub Menu1_Click()

  Frm_Utilidades.ShowModal()

End

Public Sub MenuVendedores_Click()

  Frm_Vendedores.ShowModal()

End

Public Sub ButtonVendedores_Click()

  Frm_Vendedores.ShowModal()

End

Public Sub ButtonProveedores_Click()

  Frm_Proveedores.ShowModal()

End

Public Sub MenuProveedores_Click()

  Frm_Proveedores.ShowModal()

End

Public Sub ButtonCompras_Click()

  Frm_Compras.ShowModal()

End

Public Sub MenuCompras_Click()

  Frm_Compras.ShowModal()

End

Public Sub ButtonStock_Click()

  Frm_Stock.Show()

End

Public Sub MenuStock_Click()

  Frm_Stock.Show()

End

Public Sub ButtonLotes_Click()

  Frm_Lotes.ShowModal()

End

Public Sub Menu1Lotes_Click()

  Frm_Lotes.ShowModal()

End
